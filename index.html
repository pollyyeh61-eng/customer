<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç¾æ¥­å®¢æˆ¶ç®¡ç†</title>
    <style>
        body { background-color: #000; color: #D4AF37; font-family: sans-serif; margin: 0; padding: 10px 15px 70px 15px; overflow-x: hidden; }
        .page { display: none; }
        .active { display: block; }
        h1 { color: #D4AF37; text-align: center; font-size: 20px; margin: 8px 0; letter-spacing: 2px; }

        /* å‘¼å¸é‚Šæ¡†è¼¸å…¥æ¡† */
        .form-group { margin-bottom: 10px; }
        label { display: block; color: #D4AF37; font-size: 15px; font-weight: bold; margin-bottom: 3px; }
        input, select, textarea {
            width: 100%; padding: 8px 12px; background-color: #0a0a0a;
            border: 1.5px solid #D4AF37; border-radius: 10px; color: #D4AF37; 
            font-size: 16px; box-sizing: border-box; animation: breathe 3s infinite ease-in-out;
        }
        @keyframes breathe {
            0% { border-color: #8A6D3B; box-shadow: 0 0 2px rgba(212, 175, 55, 0.2); }
            50% { border-color: #FFD700; box-shadow: 0 0 8px rgba(212, 175, 55, 0.4); }
            100% { border-color: #8A6D3B; box-shadow: 0 0 2px rgba(212, 175, 55, 0.2); }
        }
        .row { display: flex; gap: 8px; }
        .btn-save {
            width: 100%; padding: 12px; background: linear-gradient(145deg, #D4AF37, #8A6D3B);
            color: #000; border: none; border-radius: 25px; font-size: 18px; font-weight: bold; margin-top: 5px;
        }

        /* æª”æ¡ˆæŠ½å±œå°é¢å„ªåŒ– */
        .drawer { background: #111; border: 1.2px solid #D4AF37; margin-bottom: 12px; border-radius: 12px; overflow: hidden; }
        .drawer-header { padding: 12px 15px; cursor: pointer; background: #1a1a1a; position: relative; border-bottom: 1px solid #222; }
        .drawer-header h3 { margin: 0 0 6px 0; font-size: 19px; color: #FFD700; display: flex; align-items: center; }
        
        /* å°é¢é¡¯ç¤ºï¼šä¸‹æ¬¡é ç´„é‡é» */
        .drawer-header .cover-summary { 
            font-size: 14px; 
            color: #B8860B; 
            line-height: 1.5; 
            background: rgba(212, 175, 55, 0.05);
            padding: 5px 8px;
            border-radius: 6px;
        }
        .drawer-header .arrow { position: absolute; right: 15px; top: 15px; font-size: 12px; color: #D4AF37; }

        /* é»é–‹å¾Œçš„å…§å®¹ */
        .drawer-content { display: none; padding: 12px; background: #050505; }
        .history-tag { font-size: 13px; color: #8A6D3B; margin: 15px 0 8px 0; padding-left: 5px; border-left: 3px solid #D4AF37; }
        .record-item { padding: 10px; margin-bottom: 10px; background: #111; border-radius: 8px; border: 0.5px solid #333; }
        .record-item p { margin: 5px 0; font-size: 14px; color: #D4AF37; }
        
        .drawer.open .drawer-content { display: block; }
        .drawer.open .arrow { transform: rotate(180deg); }

        .nav { position: fixed; bottom: 0; left: 0; width: 100%; background: #000; display: flex; height: 60px; border-top: 1px solid #D4AF37; z-index: 100; }
        .nav-item { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; color: #8A6D3B; font-size: 11px; }
        .nav-item.active-nav { color: #FFD700; }
        .nav-icon { font-size: 20px; }
    </style>
</head>
<body>

    <div id="page1" class="page active">
        <h1>ç¾æ¥­å®¢æˆ¶ç®¡ç†</h1>
        <div class="row">
            <div class="form-group" style="flex:1;"><label>è²´è³“å§“å</label><input type="text" id="name" placeholder="è«‹è¼¸å…¥å§“å"></div>
            <div class="form-group" style="flex:1.5;"><label>è¯ç¹«é›»è©±</label><input type="tel" id="phone"></div>
        </div>
        <div class="row">
            <div class="form-group" style="flex:1;"><label>è¡€å‹</label><select id="blood"><option>Aå‹</option><option>Bå‹</option><option>Oå‹</option><option>ABå‹</option></select></div>
            <div class="form-group" style="flex:1;"><label>æ˜Ÿåº§</label><select id="constellation"><option>ç‰¡ç¾Šåº§</option><option>é‡‘ç‰›åº§</option><option>é›™å­åº§</option><option>å·¨èŸ¹åº§</option><option>ç…å­åº§</option><option>è™•å¥³åº§</option><option>å¤©ç§¤åº§</option><option>å¤©è åº§</option><option>å°„æ‰‹åº§</option><option>æ‘©ç¾¯åº§</option><option>æ°´ç“¶åº§</option><option>é›™é­šåº§</option></select></div>
        </div>
        <div class="form-group"><label>æé†’ä¸‹æ¬¡é ç´„é …ç›®</label><input type="text" id="bookItem"></div>
        <div class="form-group"><label>æé†’ä¸‹æ¬¡é ç´„æ™‚é–“</label><input type="datetime-local" id="bookTime"></div>
        <div class="form-group"><label>å¿ƒå¾—å‚™è¨»</label><textarea id="note" rows="2"></textarea></div>
        <button class="btn-save" onclick="handleSave()">ç¢ºèªå„²å­˜</button>
    </div>

    <div id="page2" class="page">
        <h1>åå–®ç¸½è¦½</h1>
        <div id="list-container"></div>
    </div>

    <div class="nav">
        <div class="nav-item active-nav" id="nav1" onclick="showPage(1)"><span class="nav-icon">ğŸ’</span><span>è³‡æ–™ç™»è¨˜</span></div>
        <div class="nav-item" id="nav2" onclick="showPage(2)"><span class="nav-icon">ğŸ“œ</span><span>åå–®ç¸½è¦½</span></div>
    </div>

    <script>
        const DB_KEY = 'BeautySystem_V3';

        function handleSave() {
            const name = document.getElementById('name').value.trim();
            if(!name) { alert('è«‹å¡«å¯«å§“å'); return; }

            const newRecord = {
                phone: document.getElementById('phone').value,
                blood: document.getElementById('blood').value,
                constellation: document.getElementById('constellation').value,
                bookItem: document.getElementById('bookItem').value,
                bookTime: document.getElementById('bookTime').value,
                note: document.getElementById('note').value,
                saveTime: new Date().toLocaleString()
            };

            let archive = JSON.parse(localStorage.getItem(DB_KEY) || '{}');
            
            // åŒåå®¢æˆ¶åˆä½µé‚è¼¯
            if(!archive[name]) archive[name] = [];
            archive[name].push(newRecord);
            
            localStorage.setItem(DB_KEY, JSON.stringify(archive));
            
            alert('å·²æ­¸æª”è‡³ ' + name + ' çš„æŠ½å±œ');
            document.querySelectorAll('input, textarea').forEach(i => i.value = '');
            showPage(2);
        }

        function showPage(num) {
            document.querySelectorAll('.page').forEach(p => p.style.display = 'none');
            document.getElementById('page' + num).style.display = 'block';
            document.getElementById('nav1').classList.toggle('active-nav', num === 1);
            document.getElementById('nav2').classList.toggle('active-nav', num === 2);
            if(num === 2) renderList();
        }

        function toggleDrawer(header) {
            header.parentElement.classList.toggle('open');
        }

        function renderList() {
            const container = document.getElementById('list-container');
            const archive = JSON.parse(localStorage.getItem(DB_KEY) || '{}');
            const names = Object.keys(archive).reverse();

            if(names.length === 0) {
                container.innerHTML = '<p style="text-align:center; color:#8A6D3B; margin-top:50px;">ç›®å‰å°šç„¡å®¢æˆ¶è³‡æ–™</p>';
                return;
            }
            
            container.innerHTML = names.map(name => {
                const records = archive[name];
                const latest = records[records.length - 1]; // å–å¾—æœ€å¾Œä¸€ç­†ç´€éŒ„ä½œç‚ºå°é¢è³‡è¨Š
                
                return `
                <div class="drawer">
                    <div class="drawer-header" onclick="toggleDrawer(this)">
                        <span class="arrow">â–¼</span>
                        <h3>ğŸ‘¤ ${name}</h3>
                        <div class="cover-summary">
                            <strong>ğŸ”” é ç´„é …ç›®ï¼š</strong>${latest.bookItem || 'æœªè¨­å®š'}<br>
                            <strong>â° é ç´„æ™‚é–“ï¼š</strong>${latest.bookTime ? latest.bookTime.replace('T', ' ') : 'æœªè¨­å®š'}
                        </div>
                    </div>
                    <div class="drawer-content">
                        <p>ğŸ“ é›»è©±ï¼š${latest.phone || 'ç„¡'}</p>
                        <p>âœ¨ å€‹äººï¼š${latest.blood} / ${latest.constellation}</p>
                        
                        <div class="history-tag">æ­·å²ç´€éŒ„ (å…± ${records.length} ç­†)</div>
                        ${records.slice().reverse().map(rec => `
                            <div class="record-item">
                                <p style="font-size:12px; color:#888;">ğŸ•’ ç™»è¨˜æ—¥æœŸï¼š${rec.saveTime}</p>
                                <p>ğŸ“Œ é …ç›®ï¼š${rec.bookItem || 'ç„¡'}</p>
                                <p>ğŸ“… æ™‚é–“ï¼š${rec.bookTime ? rec.bookTime.replace('T', ' ') : 'æœªè¨­'}</p>
                                <p>ğŸ“ å‚™è¨»ï¼š${rec.note || 'ç„¡'}</p>
                            </div>
                        `).join('')}
                    </div>
                </div>
                `;
            }).join('');
        }
    </script>
</body>
</html>
