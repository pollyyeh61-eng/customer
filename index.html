<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HolyHair 尊榮管理系統</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <style>
        body { background-color: #050505; color: #D4AF37; font-family: sans-serif; }
        .luxury-card { background: #121212; border: 1px solid #8E6D2F33; border-radius: 16px; }
        /* 4秒呼吸發光動畫 */
        @keyframes breathe {
            0%, 100% { box-shadow: 0 0 5px #8E6D2F; border-color: #8E6D2F; }
            50% { box-shadow: 0 0 20px #D4AF37; border-color: #D4AF37; }
        }
        .breathe-btn {
            animation: breathe 4s infinite ease-in-out;
            background: linear-gradient(to right, #121212, #D4AF3722);
        }
    </style>
</head>
<body>
    <div id="app" class="min-h-screen p-6 max-w-md mx-auto">
        <header class="text-center py-8">
            <h1 class="text-2xl font-bold tracking-widest text-gold">HOLY HAIR</h1>
            <p class="text-xs text-gray-500 mt-2">至臻貴賓資料同步系統</p>
        </header>

        <div class="space-y-6">
            <div>
                <label class="text-xs text-gray-400">貴賓姓名</label>
                <input v-model="form.name" type="text" class="w-full luxury-card p-3 mt-1 outline-none focus:border-gold">
            </div>
            <div>
                <label class="text-xs text-gray-400">聯繫電話</label>
                <input v-model="form.phone" type="text" class="w-full luxury-card p-3 mt-1 outline-none focus:border-gold">
            </div>
            <div>
                <label class="text-xs text-gray-400">專屬備註</label>
                <textarea v-model="form.note" class="w-full luxury-card p-3 mt-1 outline-none focus:border-gold" rows="3"></textarea>
            </div>

            <button @click="saveData" class="w-full h-14 rounded-full breathe-btn font-bold tracking-widest mt-4">
                確認儲存資料
            </button>
        </div>

        <div class="mt-12 pt-8 border-t border-gray-800">
            <h2 class="text-gold font-bold mb-4">即時名單</h2>
            <div v-for="item in customers" :key="item.id" class="luxury-card p-4 mb-3 flex justify-between items-center">
                <div>
                    <div class="font-bold">[[ item.name ]]</div>
                    <div class="text-xs text-gray-500">[[ item.phone ]]</div>
                </div>
                <div class="text-gold text-xs">查看詳情 ></div>
            </div>
        </div>
    </div>

    <script>
        // Firebase 配置
        const firebaseConfig = {
            apiKey: "AIzaSyCOhBN9TH3UJSOSx5XVyQ08f_2RUckvXYU",
            authDomain: "holyhairsalon-f73bf.firebaseapp.com",
            projectId: "holyhairsalon-f73bf",
            storageBucket: "holyhairsalon-f73bf.firebasestorage.app",
            messagingSenderId: "960169055224",
            appId: "1:960169055224:web:96d6d47280c5d543bf3c0d"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        const { createApp, ref, onMounted } = Vue;

        createApp({
            delimiters: ['[[', ']]'],
            setup() {
                const form = ref({ name: '', phone: '', note: '' });
                const customers = ref([]);

                const saveData = async () => {
                    if (!form.value.name) return alert('請輸入姓名');
                    await db.collection('customers').doc(form.value.name).set({
                        ...form.value,
                        lastUpdated: firebase.firestore.FieldValue.serverTimestamp()
                    }, { merge: true });
                    alert('貴賓資料已同步');
                    form.value = { name: '', phone: '', note: '' };
                };

                const fetchData = () => {
                    db.collection('customers').orderBy('lastUpdated', 'desc').onSnapshot(snap => {
                        customers.value = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    });
                };

                onMounted(fetchData);

                return { form, customers, saveData };
            }
        }).mount('#app');
    </script>
</body>
</html>
